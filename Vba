Sub Run()

    Dim i, cou, row, col, rox, cox, min, hour As Integer
    Dim dd, mm, yyyy As Integer
    Dim dat As Date

    row = 2
    col = 1
    rox = 8
    cox = 1
    cou = 0

    For i = 1 To 10
        Do
            
            If Worksheets("Transacciones").Cells(row, col).Value = "Empleado:" Then
                'CodigoEmpleado
                Worksheets("HorasNocturnas").Cells(rox, cox).Value = Worksheets("Transacciones").Cells(row, col + 1).Value
                'CedulaEmpleado
                Worksheets("Transacciones").Cells(row + 1, col + 2).Copy
                ActiveSheet.Paste Destination:=Worksheets("HorasNocturnas").Cells(rox, cox + 1)
                'NombreEmpleado
                Worksheets("HorasNocturnas").Cells(rox, cox + 2).Value = Worksheets("Transacciones").Cells(row, col + 2).Value
                row = row + 1
            Else
                If Worksheets("Transacciones").Cells(row, col + 5).Value = "Entrada" And Worksheets("Transacciones").Cells(row + 1, col + 5).Value = "Salida" Then
                    'RepetirDatosEmpleado
                    Worksheets("HorasNocturnas").Cells(rox, cox).Copy
                    ActiveSheet.Paste Destination:=Worksheets("HorasNocturnas").Cells(rox + 1, cox)
                    Worksheets("HorasNocturnas").Cells(rox, cox + 1).Copy
                    ActiveSheet.Paste Destination:=Worksheets("HorasNocturnas").Cells(rox + 1, cox + 1)
                    Worksheets("HorasNocturnas").Cells(rox, cox + 2).Copy
                    ActiveSheet.Paste Destination:=Worksheets("HorasNocturnas").Cells(rox + 1, cox + 2)
                    'FechaEntrada
                    dd = Mid(Worksheets("Transacciones").Cells(row, col).Value, 5, 2)
                    mm = Mid(Worksheets("Transacciones").Cells(row, col).Value, 8, 2)
                    yyyy = Mid(Worksheets("Transacciones").Cells(row, col).Value, 11, 4)
                    dat = DateSerial(yyyy, mm, dd)
                    Worksheets("HorasNocturnas").Cells(rox, cox + 3).Value = dat
                    'HoraEntrada
                    hour = Left(Worksheets("Transacciones").Cells(row, col + 1).Value, 2)
                    min = Right(Worksheets("Transacciones").Cells(row, col + 1).Value, 2)
                    If min <= 10 Then
                        Worksheets("HorasNocturnas").Cells(rox, cox + 4).Formula = "=TIME(" & hour & ", 00, 00)"
                    Else
                        Worksheets("HorasNocturnas").Cells(rox, cox + 4).Formula = "=TIME(" & hour + 1 & ", 00, 00)"
                    End If
                    Worksheets("HorasNocturnas").Range("I8").Value = hour
                    Worksheets("HorasNocturnas").Range("J8").Value = min
                    
                    row = row + 1
                    
                    'FechaSalida
                    dd = Mid(Worksheets("Transacciones").Cells(row, col).Value, 5, 2)
                    mm = Mid(Worksheets("Transacciones").Cells(row, col).Value, 8, 2)
                    yyyy = Mid(Worksheets("Transacciones").Cells(row, col).Value, 11, 4)
                    dat = DateSerial(yyyy, mm, dd)
                    Worksheets("HorasNocturnas").Cells(rox, cox + 5).Value = dat
                    'HoraSalida
                    hour = Left(Worksheets("Transacciones").Cells(row, col + 1).Value, 2)
                    min = Right(Worksheets("Transacciones").Cells(row, col + 1).Value, 2)
                    If min < 50 Then
                        Worksheets("HorasNocturnas").Cells(rox, cox + 6).Formula = "=TIME(" & hour & ", 00, 00)"
                    Else
                        Worksheets("HorasNocturnas").Cells(rox, cox + 6).Formula = "=TIME(" & hour + 1 & ", 00, 00)"
                    End If
                    
                    rox = rox + 1
                    
                End If
            
                row = row + 1
                
            End If
        
        Loop Until Worksheets("Transacciones").Cells(row, col).Value = "Total de Transacciones por Empleado:"
        
        row = row + 1
        
        'LimpiarUtimoRegistroExtra
        Worksheets("HorasNocturnas").Cells(rox, cox).Value = ""
        Worksheets("HorasNocturnas").Cells(rox, cox + 1).Value = ""
        Worksheets("HorasNocturnas").Cells(rox, cox + 2).Value = ""
    Next i
        
        Worksheets("HorasNocturnas").Range("J20").Value = row
        Worksheets("HorasNocturnas").Range("J21").Value = col
        Worksheets("HorasNocturnas").Range("J23").Value = rox
        Worksheets("HorasNocturnas").Range("J24").Value = cox

End Sub
